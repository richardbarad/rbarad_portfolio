"0","df_list <- list()"
"0",""
"0","stations <- unique(Data2$start_station_name)"
"0",""
"0","for (station in stations){"
"0","  interval60 = seq(ymd_hms('2023-06-01 00.00.00'), ymd_hms('2023-08-01 00.00.00'), by='60 mins')"
"0","  frame <-data.frame(interval60,Name=station)"
"0","  df_list <- append(df_list,list(frame))}"
"0",""
"0","holidays = c('2023-06-19','2023-07-04')"
"0",""
"0","all_data <- bind_rows(df_list) %>%"
"0","  left_join(.,Data2,join_by(interval60 == interval60,Name==start_station_name)) %>%"
"0","      mutate(week = week(interval60),"
"0","             dotw = wday(interval60, label=TRUE),"
"0","             day = floor_date(interval60, unit = ""day""),"
"0","             month = floor_date(interval60, unit = ""month""),"
"0","             sum_rides = replace_na(n,0),"
"0","             holiday = ifelse(substr(interval60,start=1,stop=10) %in% holidays, 1,0),"
"0","             is_weekend = ifelse(dotw %in% c('Sat','Sun'),1,0),"
"0","             time_of_day = case_when(hour(interval60) < 5 | hour(interval60) >= 23 ~ ""Overnight"","
"0","                                 hour(interval60) >= 5 & hour(interval60) < 10 ~ ""AM Commute"","
"0","                                 hour(interval60) >= 10 & hour(interval60) < 15 ~ ""Mid-Day"","
"0","                                 hour(interval60) >= 15 & hour(interval60) <= 19 ~ ""PM Commute"","
"0","                                 hour(interval60) >= 20 & hour(interval60) <23 ~ ""Evening"")) %>%"
"0","  dplyr::select(-n) %>%"
"0","  dplyr::filter(month != 1690848000)"
"0",""
"0","rm(Data2)"
"0","rm(df_list)"
"0","rm(frame)"
"0","rm(station)"
"0","rm(stations)"
"0","rm(interval60)"
"0",""
"0",""
"0","all_data <- all_data %>%"
"0","  arrange(Name,interval60) %>%"
"0","  group_by(Name) %>%"
"0","    mutate(lag24Hour = dplyr::lag(sum_rides,24),"
"0","           lag1week = dplyr::lag(sum_rides,24 * 7),"
"0","           clean_lag = ifelse(dotw %in% c('Mon','Sat'),lag1week,lag24Hour),"
"0","           week = ifelse(week==31,30,week))"
